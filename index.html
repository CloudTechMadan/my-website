<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Redirecting...</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
  </head>
  <body>
    <p>Redirecting...</p>
    <script>
      // Parse URL fragment (after #)
      const hash = window.location.hash.substr(1);
      const params = new URLSearchParams(hash);
      const accessToken = params.get("access_token");
      const idToken = params.get("id_token");

      if (accessToken && idToken) {
        localStorage.setItem("access_token", accessToken);
        localStorage.setItem("id_token", idToken);
        window.location.href = "admin.html";
      } else {
        // If not logged in, redirect to Cognito Hosted UI
        const domain = "face-attendance-admin-auth.auth.us-east-1.amazoncognito.com";
        const clientId = "5r9fdn5ja386taccaljn7qdlm7";
        const redirectUri = "https://cloudtechmadan.github.io/my-website/index.html";
        const responseType = "token"; // Implicit flow
        const scopes = "openid+profile+email";

        const loginUrl = `https://${domain}/login?client_id=${clientId}&response_type=${responseType}&scope=${scopes}&redirect_uri=${redirectUri}`;
        window.location.href = loginUrl;
      }
    </script>
  </body>
</html>
